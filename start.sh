#!/bin/bash

# сѓбсЃЌсЃфсЂесѓхсЃ╝сЃљсЃ╝сѓњтљїТЎѓсЂФУхитІЋсЂЎсѓІсѓ╣сѓ»сЃфсЃЌсЃѕ

echo "­Ъџђ сЃЋсЃГсЃ│сЃѕсѓесЃ│сЃЅсЂесЃљсЃЃсѓ»сѓесЃ│сЃЅсѓњУхитІЋсЂЌсЂЙсЂЎ..."
echo ""

# сЃЌсЃГсѓИсѓДсѓ»сЃѕсЃЄсѓБсЃгсѓ»сЃѕсЃфсЂФуД╗тІЋ
cd "$(dirname "$0")"

# сЃљсЃЃсѓ»сѓ░сЃЕсѓдсЃ│сЃЅсЂДсЃљсЃЃсѓ»сѓесЃ│сЃЅсѓхсЃ╝сЃљсЃ╝сѓњУхитІЋ
echo "­ЪЊА сЃљсЃЃсѓ»сѓесЃ│сЃЅсѓхсЃ╝сЃљсЃ╝сѓњУхитІЋСИГ..."
npm run dev:server > server.log 2>&1 &
SERVER_PID=$!

# т░ЉсЂЌтЙЁсЂБсЂдсЂІсѓЅсЃЋсЃГсЃ│сЃѕсѓесЃ│сЃЅсѓњУхитІЋ
sleep 2

# сЃЋсЃГсЃ│сЃѕсѓесЃ│сЃЅсѓњУхитІЋ№╝ѕсЃЋсѓЕсѓбсѓ░сЃЕсѓдсЃ│сЃЅ№╝Ѕ
echo "­Ъїљ сЃЋсЃГсЃ│сЃѕсѓесЃ│сЃЅсѓњУхитІЋСИГ..."
echo "   Рєњ http://localhost:3000"
echo ""
echo "тЂюТГбсЂЎсѓІсЂФсЂ» Ctrl+C сѓњТі╝сЂЌсЂдсЂЈсЂасЂЋсЂё"
echo ""

# сѓисѓ░сЃісЃФсЃЈсЃ│сЃЅсЃЕсЃ╝сѓњУеГт«џ
trap "echo ''; echo '­ЪЏЉ сѓхсЃ╝сЃљсЃ╝сѓњтЂюТГбсЂЌсЂЙсЂЎ...'; kill $SERVER_PID 2>/dev/null; exit" INT TERM

npm run dev

# сЃЋсЃГсЃ│сЃѕсѓесЃ│сЃЅсЂїухѓС║єсЂЌсЂЪсѓЅсђЂсЃљсЃЃсѓ»сѓесЃ│сЃЅсѓѓухѓС║є
kill $SERVER_PID 2>/dev/null
echo "РюЁ сЂЎсЂ╣сЂдсЂ«сѓхсЃ╝сЃљсЃ╝сѓњтЂюТГбсЂЌсЂЙсЂЌсЂЪ"
