# macOSでの権限設定ガイド

## npm installの権限エラーを解決する方法

### 方法1: ローカルインストールを使用（推奨）

プロジェクトディレクトリ内でnpm installを実行すると、`node_modules`はプロジェクトフォルダ内にインストールされます。これが最も安全で推奨される方法です。

```bash
cd "/Users/k.muto/webapp_01/テストデータベース"
npm install
```

### 方法2: npmのグローバルパスの権限を修正

グローバルなnpmパッケージにアクセスできない場合：

```bash
# npmのグローバルパスを確認
npm config get prefix

# グローバルパッケージのインストール先を変更（推奨）
mkdir ~/.npm-global
npm config set prefix '~/.npm-global'

# パスを追加（~/.zshrcまたは~/.bash_profileに追加）
echo 'export PATH=~/.npm-global/bin:$PATH' >> ~/.zshrc
source ~/.zshrc
```

### 方法3: システムのセキュリティ設定を確認

1. **システム環境設定を開く**
   - Appleメニュー > システム環境設定
   - または、Spotlightで「システム環境設定」を検索

2. **セキュリティとプライバシーを開く**
   - 「セキュリティとプライバシー」をクリック

3. **プライバシータブを選択**
   - 左側のメニューから「プライバシー」を選択

4. **完全なディスクアクセスを確認**
   - 左側のリストから「完全なディスクアクセス」を選択
   - ロックを解除（左下の鍵アイコンをクリックしてパスワードを入力）
   - ターミナルアプリ（Terminal.app、iTerm2など）にチェックが入っているか確認
   - チェックが入っていない場合は追加

5. **ファイルとフォルダへのアクセスを確認**
   - 左側のリストから「ファイルとフォルダ」を選択
   - ターミナルアプリが「ダウンロードフォルダ」と「書類フォルダ」にアクセスできることを確認

### 方法4: ターミナルの再起動

権限設定を変更した後は、ターミナルを完全に終了して再起動してください。

### 方法5: npmキャッシュのクリア

権限エラーが続く場合：

```bash
# npmキャッシュをクリア
npm cache clean --force

# 再度インストールを試す
npm install
```

## PC/SCサービス（カードリーダー）の権限設定

PaSoRiリーダーを使用する場合：

1. **システム環境設定 > セキュリティとプライバシー > プライバシー**
2. **USBアクセサリ**を確認（macOS Sequoia以降）
   - ターミナルアプリがUSBデバイスにアクセスできることを確認

## トラブルシューティング

### 権限エラーが続く場合

1. **プロジェクトディレクトリの権限を確認**:
   ```bash
   ls -la "/Users/k.muto/webapp_01/テストデータベース"
   ```

2. **所有者を確認**:
   ```bash
   whoami
   ```

3. **必要に応じて所有者を変更**（管理者権限が必要）:
   ```bash
   sudo chown -R $(whoami) "/Users/k.muto/webapp_01/テストデータベース"
   ```

### それでも解決しない場合

- 管理者権限でnpm installを実行（通常は推奨されません）:
  ```bash
  sudo npm install
  ```

  ただし、これはセキュリティ上のリスクがあるため、最後の手段として使用してください。
